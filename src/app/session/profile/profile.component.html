<div class="loading" *ngIf="isLoading">
    <img src="../../../assets/img/spinner2.gif">
</div>
<div class="row m-0 p-0">
    <div id="profile_back_img" class="col-lg-5 col-md-5 col-sm-12 p-0">
        <p class="text-white font-xs p-3 backg-charcoal50">
            Créditos de fotografía a
            <a class="text-yellow" href="https://unsplash.com/@soberanes?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">
                Uriel Soberanes
            </a> -
            <a class="text-yellow" href="https://unsplash.com">
                Unsplash
            </a>
        </p>
    </div>
    <div class="col-lg-7 col-md-7 col-sm-12 p-4 mx-auto backg-charcoal text-white">
        <div class="mb-3">
            <h2 class="text-center">Mi Perfil</h2>
        </div>

        <ul ngbNav #nav="ngbNav" class="nav-tabs col-12">
            <li ngbNavItem class="col-6 text-center">
                <a ngbNavLink>Información de perfil</a>
                <ng-template ngbNavContent>
                    <div class="p-3 profile-content-container">
                        <div class="col-8 mx-auto my-4">
                            <form [formGroup]="editForm" (ngSubmit)="onEdit()">
                            <div class="form-container mb-4">
                                <div class="form-group w-100 mb-2">
                                    <label for="register_placeName" class="">Nombre del establecimiento</label>
                                    <input formControlName="nombre" id="register_placeName" type="text" class="form-control" placeholder="Ingrese el nombre"/>
                                    <div *ngIf="this.nombre?.touched && this.nombre?.invalid" class="alert alert-danger">
                                        <div *ngIf="this.nombre?.errors?.required">El campo es requerido</div>
                                    </div>
                                </div>
                                <div class="form-group w-100 mb-2">
                                    <label for="register_address" class="">Dirección del establecimiento</label>
                                    <input formControlName="direccion" id="register_address" type="text" class="form-control" placeholder="Ingrese la dirección"/>
                                    <div *ngIf="this.direccion?.touched && this.direccion?.invalid" class="alert alert-danger">
                                        <div *ngIf="this.direccion?.errors?.required">El campo es requerido</div>
                                    </div>
                                </div>
                                <div class="form-group w-100 mb-2">
                                    <label for="register_phone" class="">Teléfono del establecimiento</label>
                                    <input formControlName="telefono" id="register_phone" type="text" class="form-control" placeholder="Ingrese el número telefónico"/>
                                    <div *ngIf="this.telefono?.touched && this.telefono?.invalid" class="alert alert-danger">
                                        <div *ngIf="this.telefono?.errors?.required">El campo es requerido</div>
                                        <div *ngIf="this.telefono?.errors?.pattern">El número solo se puede conformar por digitos</div>
                                        <div *ngIf="this.telefono?.errors?.minlength">El número telefónico debe conformarse de  {{this.telefono?.errors?.minlength.requiredLength}} digitos</div>
                                        <div *ngIf="this.telefono?.errors?.maxlength">El número telefónico debe conformarse de  {{this.telefono?.errors?.maxlength.requiredLength}} digitos</div>
                        
                                    </div>
                                </div>
                                <div class="form-group w-100 mb-2">
                                    <label for="register_latitude" class="">
                                        Latitud del recinto
                                        <span class="mdi mdi-information"
                                            data-toggle="tooltip"
                                            ngbPopover="Es el lado izquierdo de las coordenadas en google maps (antes de la coma), el primer número debe ser un valor comprendido entre -90 y 90."
                                            triggers="mouseenter:mouseleave"
                                        ></span>
                                    </label>
                                    <input
                                    formControlName="latitud"
                                    id="register_latitude"
                                    type="text"
                                    class="form-control"
                                    placeholder="Ejemplo: 21.047785753144087"/>
                                    <div *ngIf="this.latitud?.touched && this.latitud?.invalid" class="alert alert-danger">
                                        <div *ngIf="this.latitud?.errors?.required">El campo es requerido</div>
                                        <div *ngIf="this.latitud?.errors?.pattern">El campo debe ser númerico</div>
                                    </div>
                                </div>
                                <div class="form-group w-100 mb-2">
                                    <label for="register_longitude" class="">
                                        Longitud del recinto
                                        <span class="mdi mdi-information"
                                            data-toggle="tooltip"
                                            ngbPopover="Es el lado derecho de las coordenadas en google maps, primer número debe ser un valor comprendido entre -180 y 180."
                                            triggers="mouseenter:mouseleave"
                                        ></span>
                                    </label>
                                    <input
                                    formControlName="longitud"
                                    id="register_longitude"
                                    type="text"
                                    class="form-control"
                                    placeholder="Ejemplo: -89.64432970276357"/>
                                    <div *ngIf="this.longitud?.touched && this.longitud?.invalid" class="alert alert-danger">
                                        <div *ngIf="this.longitud?.errors?.required">El campo es requerido</div>
                                        <div *ngIf="this.longitud?.errors?.pattern">El campo debe ser númerico</div>
                                    </div>
                                </div>
                                <hr>
                            </div>
                            <button [disabled]="!isValid()" class="w-100 btn btn-forest">Actualizar información</button>
                            </form>
                        </div>
                    </div>
                </ng-template>
            </li>
            <li ngbNavItem class="col-6 text-center">
                <a ngbNavLink>Cambio de contraseña</a>
                <ng-template ngbNavContent>
                    <div class="p-3 profile-content-container">
                        <div class="col-8 mx-auto my-4">
                            <form #f="ngForm" (ngSubmit)="onRegister(f.value)">
                                <div class="mb-4">
                                    <div class="form-group w-100 mb-2">
                                        <label for="register_pass" class="">Contraseña actual</label>
                                        <input ngModel name="oldPassword" #oldPassword = "ngModel" id="register_pass" type="password" class="form-control" required  placeholder="********"/>
                                        <div *ngIf="oldPassword.touched && oldPassword.invalid" class="alert alert-danger">
                                            <div *ngIf="oldPassword.errors?.required">El campo es requerido</div>
                                            <div *ngIf="oldPassword.errors?.minlength">El campo debe tener al menos {{oldPassword.errors?.minlength.requiredLength}} caracteres</div>
                                        </div>
                                    </div>
                                    <div class="form-group w-100 mb-2">
                                        <label for="register_new_pass" class="">Nueva contraseña</label>
                                        <input ngModel name="password" 
                                        #password = "ngModel" 
                                        required 
                                        minlength="8"
                                        pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" id="register_new_pass" type="password" class="form-control" placeholder="********"/>
                                        <div *ngIf="password.touched && password.invalid" class="alert alert-danger">
                                            <div *ngIf="password.errors?.required">El campo es requerido</div>
                                            <div *ngIf="password.errors?.minlength">El campo debe tener al menos {{password.errors?.minlength.requiredLength}} caracteres</div>
                                            <div *ngIf="password.errors?.pattern"> La contraseña debe contaner un número y una letra en mínuscula y mayúscula, y tener al menos 8 caracteres</div>
                                        </div>
                                    </div>
                                    <div class="form-group w-100 mb-4">
                                        <label for="register_confirm_pass" class="">Confirmar contraseña</label>
                                        <input ngModel name="confirmPass" 
                                        #confirmPass="ngModel"
                                        required
                                        pattern="{{ password.value }}"
                                        id="register_confirm_pass"
                                        type="password"
                                        id="register_confirm_pass" type="password" class="form-control" placeholder="********"/>
                                        <div *ngIf="confirmPass.touched && confirmPass.invalid" class="alert alert-danger">
                                            <div *ngIf="confirmPass.errors?.required">El campo es requerido</div>
                                            <div *ngIf="confirmPass.errors?.pattern">Las contraseñas deben coincidir</div>
                                        </div>
                                    </div>
                                    <button class="w-100 mb-2 btn btn-forest" [disabled]="!f.valid">Cambiar contraseña</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </ng-template>
            </li>
        </ul>
        <div [ngbNavOutlet]="nav"></div>
    </div>
</div>
